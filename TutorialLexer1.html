<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Liberation Sans'; font-size:8pt; font-weight:400; font-style:normal;">
<table style="-qt-table-type: root; margin-top:72px; margin-bottom:72px; margin-left:72px; margin-right:72px;">
<tr>
<td style="border: none;">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tutorial:</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Creating the “WSH script” lexer</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#1155cc;">Intro</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Tab “Common”</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Tab “Styles”</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Tab “Parser”</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Tab “Rules”</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Tab “Sub lexers”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Intro</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">This tutorial will guide you through the creation of lexer for SynWrite - the “WSH script” lexer. WSH stands for Windows Script Host. It’s ok example of simple lexer without a tree (it means that lexer hasn’t support for “Tree Structure” panel of SynWrite).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Open “Options -- Customize lexer library” dialog in SynWrite and create a new lexer by pressing the “New lexer” button. This will show “Lexer properties” dialog. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">In the “Common” tab, enter some properties: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">“Lexer name”: “WSH script” (without quotes).</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">“File extensions”: “wsf” (extension list is space-separated, w/o quotes).</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">check the “Skip spaces while parsing” checkbox. This will cause the parser to ignore spaces in the code. This option should only be left unchecked when creating lexers for space-dependent languages such as Python.</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">add some example WSH script in the editor at the dialog bottom.</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Preview of sample WSH script:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="Pictures/100000000000021C0000011E1542340E.png" width="405.015" height="214.498" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Press “OK” to save lexer in library. Close “Lexer library” dialog (confirm to save). Now to call lexer props dialog again: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">activate the lexer (click in statusbar field, to show lexers menu)</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">call command “Options -- Customize lexer”</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Now configure all other tabs of lexer props dialog.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tab “Common”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Enter here “Token type names” list:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">Unknown</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">Comment</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">Identifier</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">Symbol</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">Integer</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Meaning of this list: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Each token type (Unknown, Comment, etc) can have its own RegEx (in “Parser” tab). After token types have RegEx attached, each token type can be referred to in “Rules” tab. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">E.g. “Rules” tab can have a rule, which finds </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">token type “Identifier” with value “procedure”, then </li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">token type “Identifier” with any value, then</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">token type “Symbol” with value “;”</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">and considers these 3 items as block beginning. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Then another rule can be added, which considers some N items as block ending. And then lexer can show entire block (from beginning to ending) in syntax tree, and/or allow folding for this block.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">In WSH lexer we don’t use “Rules” tab.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tab “Styles”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">This tab holds all styles of lexer. Some styles are binded to token type names (from tab “Common”), some are for misc purposes, e.g. highlighting of nested lexers regions or brackets BG.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Some styles can be special - ie, assigned to lexer properties in “Common” tab:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Default style - used for not parsed text (text which isn’t caught by any parser)</li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Selection mark style - used to override selected block colors (option in SynWrite)</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Search mark style - used to override “search marks” colors (placed by command “Find all/ mark” in Find dialog) (option in SynWrite)</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Current line style - used for line with caret (option in SynWrite)</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Collapse mark style - used to override “collapse marks” colors (collapsed folding blocks which look like “[...]”) (option in SynWrite)</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">It’s not recommended to use these special styles, better leave all styles on “Common” tab unassigned. And you may delete the style which maps to “Selection mark style” (it’s created by default for new lexer but isn’t needed).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Notes:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To rename a style, use the edit field below the styles listbox.</li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To disable/enable a style, use “Lock” button on “Styles” tab.</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">If option “Multiline border” is on and “Borders” lines are set, then multiline text region will show only “outer” border lines (but not inner lines inside the region).</li>
<li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">It’s not recommended to use options “Hidden” and “Read only”, it may confuse user if he can’t see or edit some region.</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tab “Parser”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">In this tab we must create parsers, which can parse text to predefined token types (token types are on “Common” tab). Created parsers:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">“Comment” - token type “Comment” - to catch multiline comments <span style=" font-size:8pt; color:#073763;">/*......*/</span>. Regex is with (?s) option to catch multiline text - </li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">(?s)/\* .*? \*/</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“Comment 2” - token type “Comment” too - to catch single-line comments starting from chars ‘ or //. Regex -</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">'.* | //.*</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“Comment 3” - token type “Comment” too - to catch HTML comments (WSH needs it): </span>&lt;!--........--&gt;<span style=" font-size:11pt; color:#000000;">. Regex is with (?s) again - </span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">(?s)&lt;!-- .*? →</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“Symbol” - token type “Symbol” - to catch special chars (brackets, commas, equals etc). Regex - </span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">[;:=&lt;&gt;\./\?\(\)\[\]]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“String” - token type “String” - to catch double-quotes strings. Regex (note that unclosed string will highlight to the line end) -</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">&quot;.*?(&quot;|$)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“Tag” - token type “Tag” - WSH is tag based so it’s good to highlight tags in special color. Parser has regex which can catch both “&lt;tag” and “&lt;/tag” (opening and closing tags). Regex uses “lookahead assertions”, see about it in SynWrite help topic about RegEx.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">(?&lt;=&lt;) \w+ |</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">(?&lt;=&lt;/) \w+</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#073763;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">“Id” - token type “Identifier” - to catch all id’s not catched by previous parsers. Regex is usual, any name starting from letter or “_” -</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#073763;">[a-z_]\w*</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#073763;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Note:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">You can import some of these parsers from other lexers. (This doesn’t mean importing of lexers! This means importing only of lexer parts, using the “Import items” toolbar button on “Parsers” tab.) Press “Import items” toolbar button and select some items e.g. from C lexer. After importing correct the parsers’ “token type” and “token style” (because C lexer has different token types).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Note:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">you can add “Number” parser too, for token type “Integer”. Just create new style for numbers, and use regex “\d+”. But WSH doesn’t need it, only embedded JS parts need it (and this is catched by JS sub lexer, no need in new parser).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tab “Rules”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">We don’t use it.</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:21pt; color:#000000;">Tab “Sub lexers”</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:21pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">This tab will hold items for highlighting JavaScript and VBScript embedded scripts. Lexer library must contain these 2 lexers (otherwise feature won’t work).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">For item “JavaScript” specify JS lexer name and such props:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:11pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">start condition: </li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#1c4587;">(?i)&lt;script \s .*? language=&quot;(JavaScript|JScript)&quot;&gt;</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#1c4587;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">end condition:</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#1c4587;">(?i)&lt;/script&gt;</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#1c4587;" style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">(optional) style: some style which holds BG color only. This allows to highlight JS parts in different BG color.</span></li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">These values must give correct highlighting of embedded JS code in example script. Ie, keywords “if”/”var” must be bold, and folding for “if” blocks must appear.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">Note that regex contains “\s” for space, needed as spaces are ignored in regex fields. Note that “(?i)” regex modifier is used, to make regex case-insensitive.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4.66203e-310px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt; color:#000000;">For item “VBScript” similar props must be set (see result lexer).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; color:#000000;"><br /></p></td></tr></table></body></html>